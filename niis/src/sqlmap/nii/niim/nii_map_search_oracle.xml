<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="nii_search_juso_oracle">

	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>

	<!-- 도로명 - 읍면 -->
	<select id="jusoSearchDAO.selectEmdList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT DISTINCT 
			EMD_CD, 
			EMD_NM 
		FROM ROAD_ADDR_RN_CD@DL_SMART 
		WHERE 
			SIDO_NM=#sidoNm# 
			AND SGG_NM=#sggNm# 
			AND EMD_DIVI='0'
		ORDER BY EMD_NM
	</select>
	
	
	<!-- 통합검색(도로명) -->
	<select id="jusoSearchDAO.selectRnNmList" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT DISTINCT 
			RN_CD, 
			RN_NM 
		FROM ROAD_ADDR_RN_CD@DL_SMART 
		WHERE 
			SIDO_NM=#sidoNm#
			AND SGG_NM=#sggNm#
			<isNotEmpty property="emdCd">
				AND EMD_CD=#emdCd#
			</isNotEmpty>
			<isEmpty property="emdCd">
				AND EMD_DIVI = '1'
			</isEmpty>
		ORDER BY RN_NM
	</select>
	
	<!-- 지도 : 인덱스 검색을 위한 축척 목록 조회 -->
	<select id="indexSearchDAO.selectIndexScale" resultClass="java.util.HashMap">
		SELECT DISTINCT SCALE, '1:' || TO_CHAR(SCALE,'FM999,999') SCALE_NM 
		FROM NGI_MAP_INDEX@DL_NGIIDMMS ORDER BY 1
	</select>
	
	<!-- 지도 : 인덱스 검색을 위한 도엽명 이니셜 목록 조회 -->	
	<select id="indexSearchDAO.selectIndexInitName" resultClass="java.util.HashMap" parameterClass="java.util.HashMap">
		SELECT DISTINCT 
			CASE WHEN NAME IS NOT NULL 
				THEN SUBSTR(DECOMPOSE(CAST(NAME AS NVARCHAR2(14))),0,1) 
				ELSE SUBSTR(DECOMPOSE(CAST('-' AS NVARCHAR2(14))),0,1)  END INIT,
			CASE WHEN NAME IS NOT NULL 
				THEN ASCII(SUBSTR(DECOMPOSE(CAST(NAME AS NVARCHAR2(14))),0,1)) 
				ELSE NULL END A_INIT
		FROM (SELECT SCALE, NUM, CASE WHEN NAME IS NULL THEN '-' ELSE NAME END NAME FROM NGI_MAP_INDEX@DL_NGIIDMMS WHERE SCALE=#scale#)
		ORDER BY 1,2
	</select>
	
	<!-- 지도 : 인덱스 검색을 위한 도엽명 목록 조회 -->
	<select id="indexSearchDAO.selectIndexName" resultClass="java.util.HashMap" parameterClass="java.util.HashMap">
		SELECT DISTINCT NAME
		FROM (
				SELECT ASCII(SUBSTR(DECOMPOSE(CAST(NAME AS NVARCHAR2(14))),0,1)) A_INIT, NAME
				FROM (SELECT SCALE, NUM, CASE WHEN NAME IS NULL THEN '-' ELSE NAME END NAME FROM NGI_MAP_INDEX@DL_NGIIDMMS WHERE SCALE = #scale#)				
			)
		WHERE A_INIT=#aInit#       
		ORDER BY NAME
	</select>
	
	<!-- 지도 : 인덱스 검색을 위한 도엽명으로 조회 -->
	<select id="indexSearchDAO.selectIndexNum" resultClass="java.util.HashMap" parameterClass="java.util.HashMap">
		SELECT DISTINCT NUM, XMIN, YMIN, XMAX, YMAX
		FROM (SELECT SCALE, NUM, MINX XMIN, MINY YMIN, MAXX XMAX, MAXY YMAX FROM NGI_MAP_INDEX@DL_NGIIDMMS WHERE SCALE=#scale# AND NAME=#name#)
		ORDER BY NUM
	</select>
	
	<!-- 지도 : 인덱스 검색을 위한 도엽번호로 조회 -->
	<select id="indexSearchDAO.selectIndexNum2" resultClass="java.util.HashMap" parameterClass="java.lang.String">
		SELECT DISTINCT SCALE, NUM, MINX XMIN, MINY YMIN, MAXX XMAX, MAXY YMAX FROM NGI_MAP_INDEX@DL_NGIIDMMS
		WHERE NUM=#value#
	</select>
	
</sqlMap>
